<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Box and Whisker Chart Example</title>
  <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Patrick Hand', cursive;
      padding: 20px;
    }
    #chart-container {
      width: 100%;
      max-width: 600px;
      height: 400px;
      margin: auto;
    }
  </style>
</head>
<body>

<h1>Box and Whisker Plot Demo</h1>
<p>This is a simple example chart with handwriting-style font.</p>

<div id="chart-container">
  <canvas id="myChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-chart-box-and-violin-plot/build/Chart.BoxPlot.js"></script>
<script>
  // Ensure chart.js v2 and the plugin are loaded correctly before initializing the chart.
  window.addEventListener('load', () => {
    const canvas = document.getElementById('myChart');
    if (!canvas) {
      console.error('Canvas with id "myChart" not found!');
      return;
    }

    const ctx = canvas.getContext('2d');

    const chartData = {
      labels: ['Group A', 'Group B', 'Group C', 'Group D'],
      datasets: [
        {
          label: 'Taxa 1',
          backgroundColor: 'rgba(75, 192, 192, 0.7)',
          borderColor: 'rgba(75, 192, 192, 1)',
          borderWidth: 1,
          outlierColor: '#999999',
          padding: 10,
          itemRadius: 0,
          data: [
            { min: 5, q1: 10, median: 15, q3: 20, max: 25 },
            { min: 7, q1: 12, median: 18, q3: 22, max: 26 },
            { min: 10, q1: 15, median: 20, q3: 25, max: 30 },
            { min: 9, q1: 14, median: 19, q3: 24, max: 29 }
          ]
        },
        {
          label: 'Taxa 2',
          backgroundColor: 'rgba(255, 159, 64, 0.7)',
          borderColor: 'rgba(255, 159, 64, 1)',
          borderWidth: 1,
          outlierColor: '#999999',
          padding: 10,
          itemRadius: 0,
          data: [
            { min: 6, q1: 11, median: 16, q3: 21, max: 26 },
            { min: 8, q1: 13, median: 19, q3: 23, max: 27 },
            { min: 11, q1: 16, median: 21, q3: 26, max: 31 },
            { min: 10, q1: 15, median: 20, q3: 25, max: 30 }
          ]
        }
      ]
    };

    const chartConfig = {
      type: 'boxplot',  // Now it should work because the plugin is loaded properly
      data: chartData,
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: 'top' },
          tooltip: { enabled: true }
        },
        scales: {
          y: { beginAtZero: true }
        }
      }
    };

    new Chart(ctx, chartConfig);
  });
</script>

</body>
</html>
